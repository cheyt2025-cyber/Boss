local Players = game:GetService("Players")
local VirtualUser = game:GetService("VirtualUser")
local TeleportService = game:GetService("TeleportService")
local LocalPlayer = Players.LocalPlayer

-- Permanent Anti-AFK
LocalPlayer.Idled:Connect(function()
    VirtualUser:Button2Down(Vector2.new(0, 0), workspace.CurrentCamera.CFrame)
    task.wait(1)
    VirtualUser:Button2Up(Vector2.new(0, 0), workspace.CurrentCamera.CFrame)
end)

-- Load Zaporium UI Library
local Library = loadstring(game:HttpGet('https://raw.githubusercontent.com/cheyt2025-cyber/HAYS-AI/refs/heads/main/ZAPORIUM'))()

-- Main Window
local Window = Library.CreateWindow({
    Name = "ZAPORIUM",
    LoadingTitle = "Zaporium",
    ConfigurationSaving = {Enabled = false},
    AccentColor = Color3.fromRGB(0, 212, 255),
    Logo = "rbxassetid://112586636995159",
    Credit = "Created by ScriptZap",
    EnableBooting = true
})

-- Info Tab
local InfoTab = Window:CreateTab("Info")
InfoTab:CreateLabel("Welcome to ZAPORIUM! ‚ú®")
InfoTab:CreateLabel("Thank you so much for using my script! ‚ù§Ô∏è")
InfoTab:CreateLabel("Made with love ‚Ä¢ Clean ‚Ä¢ Fast ‚Ä¢ Powerful")
InfoTab:CreateLabel("I hope you enjoy every second using it!")
InfoTab:CreateLabel("Your support keeps me going! üöÄ")
InfoTab:CreateLabel("")
InfoTab:CreateLabel("~ ScriptZap")
InfoTab:CreateLabel("ZAPORIUM ‚Ä¢ Simple, Clean, Powerful")

InfoTab:CreateButton({
    Name = "üìã Join Discord Server",
    Callback = function()
        setclipboard("https://discord.gg/FCwb52g5")
        Window:Notify("Discord link copied to clipboard! üéâ", 4)
    end
})

-- ==================== MAIN TAB ====================
local MainTab = Window:CreateTab("Main")

-- Auto Collect Coin
local coinHolder = workspace:WaitForChild("Gameplay"):WaitForChild("CoinHolder")
local triggeredCoins = {}
local autoCoinEnabled = false
local coinLoop

MainTab:CreateToggle({
    Name = "Auto Collect Coin",
    Default = false,
    Callback = function(state)
        autoCoinEnabled = state
        if state then
            Window:Notify("Auto Collect Coin ‚Ä¢ Enabled", 3)
            coinLoop = task.spawn(function()
                while autoCoinEnabled do
                    for _, obj in pairs(coinHolder:GetDescendants()) do
                        if obj:IsA("ProximityPrompt") and not triggeredCoins[obj] then
                            fireproximityprompt(obj)
                            triggeredCoins[obj] = true
                        end
                    end
                    task.wait(0.25)
                end
            end)
        else
            Window:Notify("Auto Collect Coin ‚Ä¢ Disabled", 3)
        end
    end
})

-- Auto Collect Items (Fixed & Perfect)
local autoItemEnabled = false
local itemLoop
local plot = nil
local itemCache = nil
local alreadyCollectedNames = {}

local function findPlayerPlot()
    repeat
        task.wait(0.5)
        plot = workspace.Gameplay.Plots:FindFirstChild(LocalPlayer.Name)
        or workspace.Gameplay.Plots:FindFirstChild(tostring(LocalPlayer.UserId))
    until plot

    itemCache = plot:WaitForChild("PlotLogic"):WaitForChild("ItemCache")
    print("Your plot found:", plot.Name)
    Window:Notify("Plot detected ‚Ä¢ Auto Collect Items ready!", 4)
end

local function autoCollectItemsLoop()
    while autoItemEnabled do
        if not plot or not itemCache then findPlayerPlot() end
        for _, descendant in itemCache:GetDescendants() do
            if descendant:IsA("ProximityPrompt") then
                local item = descendant.Parent
                if item and item.Parent == itemCache then
                    local itemName = item.Name
                    if not alreadyCollectedNames[itemName] then
                        fireproximityprompt(descendant)
                        alreadyCollectedNames[itemName] = true
                    end
                end
            end
        end
        task.wait(0.5)
    end
end

MainTab:CreateToggle({
    Name = "Auto Collect Items",
    Default = false,
    Callback = function(state)
        autoItemEnabled = state
        if state then
            if not plot then findPlayerPlot() end
            Window:Notify("Auto Collect Items ‚Ä¢ Enabled", 4)
            itemLoop = task.spawn(autoCollectItemsLoop)
        else
            Window:Notify("Auto Collect Items ‚Ä¢ Disabled", 3)
        end
    end
})

-- Auto Open Container
local autoContainerEnabled = false
local containerLoop
local containerHolder = nil
local triggeredPrompts = {}

local function setupContainerOpener()
    if not plot then
        repeat task.wait(0.5)
            plot = workspace.Gameplay.Plots:FindFirstChild(LocalPlayer.Name)
            or workspace.Gameplay.Plots:FindFirstChild(tostring(LocalPlayer.UserId))
        until plot
    end
    containerHolder = plot:WaitForChild("PlotLogic"):WaitForChild("ContainerHolder")
end

MainTab:CreateToggle({
    Name = "Auto Open Container",
    Default = false,
    Callback = function(state)
        autoContainerEnabled = state
        if state then
            if not plot or not containerHolder then setupContainerOpener() end
            Window:Notify("Auto Open Container ‚Ä¢ Enabled", 4)
            containerLoop = task.spawn(function()
                while autoContainerEnabled do
                    for _, obj in containerHolder:GetDescendants() do
                        if obj:IsA("ProximityPrompt") and not triggeredPrompts[obj] then
                            fireproximityprompt(obj)
                            triggeredPrompts[obj] = true
                        end
                    end
                    task.wait(0.4)
                end
            end)
        else
            Window:Notify("Auto Open Container ‚Ä¢ Disabled", 3)
        end
    end
})

-- Fast Customer
local CustomersFolder = workspace:WaitForChild("Gameplay"):WaitForChild("Customers")
local fastCustomerEnabled = false
local fastCustomerConnection

local function speedUpCustomer(customer)
    if not customer or not customer:IsA("Model") then return end
    task.wait()
    local humanoid = customer:FindFirstChild("Humanoid")
    if humanoid then humanoid.WalkSpeed = 50 end
end

local function enableFastCustomers()
    for _, customer in pairs(CustomersFolder:GetChildren()) do speedUpCustomer(customer) end
    fastCustomerConnection = CustomersFolder.ChildAdded:Connect(speedUpCustomer)
end

local function disableFastCustomers()
    if fastCustomerConnection then fastCustomerConnection:Disconnect() fastCustomerConnection = nil end
end

MainTab:CreateToggle({
    Name = "Fast Customer",
    Default = false,
    Callback = function(state)
        fastCustomerEnabled = state
        if state then
            enableFastCustomers()
            Window:Notify("Fast Customer ‚Ä¢ Enabled (50 WalkSpeed)", 4)
        else
            disableFastCustomers()
            Window:Notify("Fast Customer ‚Ä¢ Disabled", 3)
        end
    end
})

-- ==================== NEW: AUTO DROP ALL ITEMS TOGGLE ====================
local autoDropAllEnabled = false
local dropAllLoop
local firesignal = (getrenv and getrenv()._G and getrenv()._G.firesignal) or firesignal

local function getDropAllButton()
    local gui = LocalPlayer:FindFirstChild("PlayerGui")
    if not gui then return end
    local backpackGui = gui:FindFirstChild("BackpackGui")
    if not backpackGui then return end
    local backpack = backpackGui:FindFirstChild("Backpack")
    if not backpack then return end
    local hotbar = backpack:FindFirstChild("Hotbar")
    if not hotbar then return end
    return hotbar:FindFirstChild("DropAll")
end

local function autoDropAllLoop()
    while autoDropAllEnabled do
        local dropBtn = getDropAllButton()
        if dropBtn and dropBtn:IsA("TextButton") and dropBtn.Visible and dropBtn.Parent.Visible then
            if dropBtn.Activated then
                firesignal(dropBtn.Activated)
            end
            if dropBtn.MouseButton1Click then
                firesignal(dropBtn.MouseButton1Click)
            end
        end
        task.wait(0.3) -- Fast & efficient
    end
end

MainTab:CreateToggle({
    Name = "Auto Drop All Items",
    Default = false,
    Callback = function(state)
        autoDropAllEnabled = state
        if state then
            Window:Notify("Auto Drop All Items ‚Ä¢ Enabled", 4)
            dropAllLoop = task.spawn(autoDropAllLoop)
        else
            Window:Notify("Auto Drop All Items ‚Ä¢ Disabled", 3)
        end
    end
})
MainTab:CreateLabel("You need to Hold Any item to Drop All") -- Description under the toggle

-- Reset on death
LocalPlayer.CharacterAdded:Connect(function()
    triggeredCoins = {}
    alreadyCollectedNames = {}
    triggeredPrompts = {}
    plot = nil
    itemCache = nil
    containerHolder = nil
end)

-- ==================== MISC TAB ====================
local MiscTab = Window:CreateTab("Misc")

MiscTab:CreateSlider({
    Name = "WalkSpeed",
    Min = 16,
    Max = 300,
    Default = 16,
    Callback = function(value)
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
            LocalPlayer.Character.Humanoid.WalkSpeed = value
        end
        LocalPlayer.CharacterAdded:Connect(function(char)
            task.wait(0.5)
            if char:FindFirstChild("Humanoid") then
                char.Humanoid.WalkSpeed = value
            end
        end)
    end
})

MiscTab:CreateButton({
    Name = "Rejoin Server",
    Callback = function()
        Window:Notify("Rejoining server...", 3)
        task.wait(0.3)
        TeleportService:Teleport(game.PlaceId, LocalPlayer)
    end
})

-- Success
Window:Notify("ZAPORIUM Fully Loaded!", 7)
print("ZAPORIUM by ScriptZap")
