-- LocalScript (StarterPlayerScripts) - Auto-Claimer + Status + Cheese Event + Remove Lava + Auto Collect
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local hrp = character:WaitForChild("HumanoidRootPart", 10)
local humanoid = character:WaitForChild("Humanoid", 10)
if not hrp or not humanoid then return end

local BrainrotsFolder = workspace:WaitForChild("GameFolder"):WaitForChild("Brainrots")
local CheeseFolder    = workspace:WaitForChild("GameFolder"):WaitForChild("CheeseFolder")
local LavasFolder     = workspace:WaitForChild("GameFolder"):WaitForChild("Lavas")
local PlotsFolder     = workspace:WaitForChild("GameFolder"):WaitForChild("Plots")

-- HOME POSITION
local HOME_CFRAME = CFrame.new(15.32, 22.74, 27.24)

-- Toggle states
local enabledRarities = {
    Epic      = false,
    Legendary = false,
    Mythic    = false,
    Secret    = false,
    Celestial = false,
    Divine    = false,
}

local autoCheeseEnabled = false
local autoCollectEnabled = false

-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
-- AUTO COLLECT (Plots â†’ Places â†’ Claim)
-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

local myPlot

local function detectPlot()
    for _, plot in ipairs(PlotsFolder:GetChildren()) do
        local att = plot:FindFirstChild("YourBaseAtt")
        if not att then continue end
        
        local gui = att:FindFirstChild("BillboardGui")
        if not gui then continue end
        
        local title = gui:FindFirstChild("Title")
        if title and title.Text == "YOUR BASE" then
            return plot
        end
    end
    return nil
end

-- One-time plot detection
task.spawn(function()
    repeat
        task.wait(0.3)
        myPlot = detectPlot()
    until myPlot or not player.Parent  -- safety
    if myPlot then
        print("ğŸ—ºï¸ My plot detected:", myPlot.Name)
    else
        warn("Could not find YOUR BASE plot")
    end
end)

local function getHRP()
    local char = player.Character
    if char then
        local root = char:FindFirstChild("HumanoidRootPart")
        if root then return root end
    end
    return player.CharacterAdded:Wait():WaitForChild("HumanoidRootPart", 8)
end

local function claimAll()
    if not myPlot then 
        print("âš ï¸ Plot not detected yet â€” skipping claim cycle")
        return 
    end
    
    local placesFolder = myPlot:FindFirstChild("Places")
    if not placesFolder then 
        print("âš ï¸ Places folder not found in plot")
        return 
    end
    
    local currentHRP = getHRP()
    if not currentHRP then return end
    
    local children = placesFolder:GetChildren()
    if #children == 0 then return end
    
    print("ğŸ”„ Found", #children, "places â€” starting claims...")
    
    for i, place in ipairs(children) do
        local claimPart = place:FindFirstChild("Claim")
        if not claimPart or not claimPart:IsA("BasePart") then
            continue
        end
        
        firetouchinterest(currentHRP, claimPart, 0)
        task.wait()
        firetouchinterest(currentHRP, claimPart, 1)
        
        if i % 5 == 0 then
            task.wait(0.15)
        end
        
        if i % 10 == 0 then
            print("Claimed", i, "/", #children)
        end
    end
    
    print("âœ… Claim cycle finished!")
end

-- Auto collect loop when enabled
task.spawn(function()
    while true do
        if autoCollectEnabled and myPlot then
            claimAll()
        end
        task.wait(5.5)  -- adjust this delay: 4â€“8 seconds recommended
    end
end)

-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
-- BRAINROT / CHEESE FUNCTIONS (unchanged)
-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

local function isTargetRarity(text)
    return enabledRarities[text] == true
end

local function getRarity(model)
    if not model:IsA("Model") then return nil end
    local root = model:FindFirstChild("RootPart")
    if not root then return nil end
    local att = root:FindFirstChild("BrainrotAtt")
    if not att then return nil end
    local gui = att:FindFirstChildWhichIsA("BillboardGui")
    if not gui then return nil end
    local rarityLabel = gui:FindFirstChild("Rarity")
    if not rarityLabel or not rarityLabel:IsA("TextLabel") then return nil end
    local text = rarityLabel.Text:match("^%s*(.-)%s*$") or ""
    return text
end

local function getTargetCFrame(obj)
    if obj:IsA("BasePart") then
        return obj.CFrame
    elseif obj.PrimaryPart then
        return obj.PrimaryPart.CFrame
    else
        local part = obj:FindFirstChildWhichIsA("BasePart", true)
        if part then
            return part.CFrame
        end
    end
    return nil
end

local function teleportTo(obj, label)
    if not hrp or not hrp.Parent or humanoid.Health <= 0 or not autoCheeseEnabled then return end
    local targetCFrame = getTargetCFrame(obj)
    if targetCFrame then
        hrp.CFrame = targetCFrame + Vector3.new(0, 3, 0)
        print("ğŸ§€ " .. (label or "?") .. " â†’ " .. obj.Name)
        task.wait(1.2)
    end
end

local function sweepCheeses()
    if not autoCheeseEnabled or not hrp or not hrp.Parent or humanoid.Health <= 0 then return end
    print("ğŸ§€ Initial sweep of current cheeses...")
    local cheeses = CheeseFolder:GetChildren()
    for i, obj in ipairs(cheeses) do
        teleportTo(obj, "#" .. i)
    end
    print("âœ… Cheese sweep completed!")
end

local function simulateHoldAndTrigger(prompt)
    if not prompt or not prompt.Parent then return false end
    print(" â±ï¸ Starting hold (" .. prompt.HoldDuration .. "s)")
    prompt:InputHoldBegin()
    task.wait(prompt.HoldDuration + 0.4)
    prompt:InputHoldEnd()
    print(" â±ï¸ Hold released")
    task.wait(1.0)
    return not prompt.Parent or not prompt.Enabled
end

local function tryClaimBrainrot(model)
    local root = model:FindFirstChild("RootPart")
    if not root then print("âŒ No RootPart: " .. model.Name) return false end
    local prompt = root:FindFirstChildWhichIsA("ProximityPrompt")
    if not prompt then print("âŒ No Prompt: " .. model.Name) return false end
    local rarity = getRarity(model)
    print("ğŸ¯ CLAIMING: " .. model:GetFullName() .. " (" .. (rarity or "???") .. ")")
    hrp.AssemblyLinearVelocity = Vector3.new(0,0,0)
    hrp.AssemblyAngularVelocity = Vector3.new(0,0,0)
    local safeHeight = 3.8
    local abovePos = root.Position + Vector3.new(math.random(-5,5)/10, safeHeight, math.random(-5,5)/10)
    hrp.CFrame = CFrame.lookAt(abovePos, root.Position)
    print(" ğŸ“ Teleported above (dist â‰ˆ " .. string.format("%.1f", (hrp.Position - root.Position).Magnitude) .. ")")
    task.wait(0.5)
    hrp.Anchored = true
    print(" ğŸ”’ Anchored")
    local success = simulateHoldAndTrigger(prompt)
    hrp.Anchored = false
    task.wait(0.15)
    hrp.CFrame = HOME_CFRAME
    print(" ğŸ  Returned home")
    if success then
        print("âœ… SUCCESS: " .. model.Name)
        return true
    else
        print("âš ï¸ Prompt still visible?")
        return false
    end
end

local function scanAndClaim()
    if not hrp or not hrp.Parent or humanoid.Health <= 0 then return end
    local anyEnabled = false
    for _, v in pairs(enabledRarities) do if v then anyEnabled = true break end end
    if not anyEnabled then return end
    print("\nğŸ” SCAN (one per cycle)")
    local claimed = false
    for _, cat in ipairs(BrainrotsFolder:GetChildren()) do
        if cat:IsA("Folder") and not claimed then
            for _, model in ipairs(cat:GetChildren()) do
                if claimed then break end
                local rarity = getRarity(model)
                if rarity and isTargetRarity(rarity) then
                    if tryClaimBrainrot(model) then claimed = true end
                    break
                end
            end
        end
        if claimed then break end
    end
    if not claimed then print(" No matching rarity found this cycle") end
    print("ğŸ”¥ CYCLE DONE\n")
end

-- Cheese spawn watcher
CheeseFolder.ChildAdded:Connect(function(obj)
    task.spawn(function()
        task.wait(0.3)
        if autoCheeseEnabled and obj.Parent and hrp and hrp.Parent and humanoid.Health > 0 then
            teleportTo(obj, "NEW")
        end
    end)
end)

-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
-- STATUS GUI (unchanged)
-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

local statusGuiVisible = false
local statusScreenGui = Instance.new("ScreenGui")
statusScreenGui.Name = "BrainrotsStatus"
statusScreenGui.ResetOnSpawn = false
statusScreenGui.Enabled = false
statusScreenGui.Parent = player:WaitForChild("PlayerGui")

local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.AnchorPoint = Vector2.new(1, 0)
MainFrame.Position = UDim2.new(1, -15, 0, 15)
MainFrame.Size = UDim2.new(0, 185, 0, 130)
MainFrame.BackgroundColor3 = Color3.fromRGB(10, 12, 25)
MainFrame.BorderSizePixel = 0
MainFrame.Active = true
MainFrame.Draggable = true
MainFrame.ClipsDescendants = true
MainFrame.Parent = statusScreenGui

local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 14)
UICorner.Parent = MainFrame

local UIGradient = Instance.new("UIGradient")
UIGradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(18, 20, 45)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(8, 8, 20))
}
UIGradient.Rotation = 90
UIGradient.Parent = MainFrame

local FrameGlow = Instance.new("UIStroke")
FrameGlow.Color = Color3.fromRGB(0, 180, 255)
FrameGlow.Thickness = 2
FrameGlow.Transparency = 0.5
FrameGlow.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
FrameGlow.Parent = MainFrame

local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, -20, 0, 30)
Title.Position = UDim2.new(0, 10, 0, 8)
Title.BackgroundTransparency = 1
Title.Text = "Brainrots STATUS"
Title.TextColor3 = Color3.fromRGB(0, 215, 255)
Title.TextSize = 16
Title.Font = Enum.Font.GothamBlack
Title.TextStrokeTransparency = 0.75
Title.TextStrokeColor3 = Color3.fromRGB(0, 140, 220)
Title.Parent = MainFrame

local StatusContainer = Instance.new("Frame")
StatusContainer.Size = UDim2.new(1, -20, 1, -48)
StatusContainer.Position = UDim2.new(0, 10, 0, 42)
StatusContainer.BackgroundTransparency = 1
StatusContainer.Parent = MainFrame

local function scanRarities()
    local counts = {Secret = 0, Celestial = 0, Godly = 0}
    for _, cat in ipairs(BrainrotsFolder:GetChildren()) do
        if cat:IsA("Folder") then
            for _, model in ipairs(cat:GetChildren()) do
                local rarity = getRarity(model)
                if rarity and counts[rarity] then
                    counts[rarity] += 1
                end
            end
        end
    end
    return counts
end

local function updateStatusGUI()
    StatusContainer:ClearAllChildren()
    local entries = {
        {rarity = "Secret",    color = Color3.fromRGB(180, 100, 255)},
        {rarity = "Celestial", color = Color3.fromRGB(0, 220, 255)},
        {rarity = "Godly",     color = Color3.fromRGB(255, 215, 0)}
    }
    local spacing = 28
    for i, data in ipairs(entries) do
        local count = scanRarities()[data.rarity] or 0
        local entry = Instance.new("Frame")
        entry.Size = UDim2.new(1, 0, 0, spacing)
        entry.Position = UDim2.new(0, 0, 0, (i-1)*(spacing+2))
        entry.BackgroundTransparency = 1
        entry.Parent = StatusContainer
        local label = Instance.new("TextLabel")
        label.Size = UDim2.new(1, -12, 1, 0)
        label.Position = UDim2.new(0, 6, 0, 0)
        label.BackgroundTransparency = 1
        label.Text = data.rarity .. ": " .. count
        label.TextColor3 = count > 0 and data.color or Color3.fromRGB(110, 110, 140)
        label.TextSize = 14
        label.Font = Enum.Font.GothamSemibold
        label.TextXAlignment = Enum.TextXAlignment.Left
        label.TextYAlignment = Enum.TextYAlignment.Center
        label.Parent = entry
        local glow = Instance.new("UIStroke")
        glow.Color = count > 0 and data.color or Color3.fromRGB(70, 70, 90)
        glow.Thickness = count > 0 and 1.4 or 0.8
        glow.Transparency = count > 0 and 0.4 or 0.75
        glow.Parent = label
    end
end

task.spawn(function()
    while true do
        task.wait(1.4)
        if statusGuiVisible then
            updateStatusGUI()
        end
    end
end)

-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
-- GUI (Zaporium)
-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

local library = loadstring(game:HttpGet("https://raw.githubusercontent.com/Zap-Zaporium/Zap-is-Me/refs/heads/main/Zaporium.lua"))()
local Window = library:CreateWindow("Survive Lava for Brainrots")

local Main = Window:AddFolder("Main Features")

Main:AddToggle({text = "Get Epic",      state = false, callback = function(v) enabledRarities.Epic      = v print("Get Epic:",      v and "ON" or "OFF") end})
Main:AddToggle({text = "Get Legendary", state = false, callback = function(v) enabledRarities.Legendary = v print("Get Legendary:", v and "ON" or "OFF") end})
Main:AddToggle({text = "Get Mythic",    state = false, callback = function(v) enabledRarities.Mythic    = v print("Get Mythic:",    v and "ON" or "OFF") end})
Main:AddToggle({text = "Get Secret",    state = false, callback = function(v) enabledRarities.Secret    = v print("Get Secret:",    v and "ON" or "OFF") end})
Main:AddToggle({text = "Get Celestial", state = false, callback = function(v) enabledRarities.Celestial = v print("Get Celestial:", v and "ON" or "OFF") end})
Main:AddToggle({text = "Get Divine",    state = false, callback = function(v) enabledRarities.Divine    = v print("Get Divine:",    v and "ON" or "OFF") end})

Main:AddButton({
    text = "Status",
    callback = function()
        statusGuiVisible = not statusGuiVisible
        statusScreenGui.Enabled = statusGuiVisible
        if statusGuiVisible then
            updateStatusGUI()
            print("Status panel â†’ ON")
        else
            print("Status panel â†’ OFF")
        end
    end
})

Main:AddToggle({
    text = "Auto Collect",
    state = false,
    callback = function(v)
        autoCollectEnabled = v
        print("ğŸ”„ Auto Collect:", v and "ON" or "OFF")
        if v and myPlot then
            task.spawn(claimAll)  -- run once immediately when turning on
        end
    end
})

Main:AddLabel({text = "YT: ScriptZap0"})

-- Cheese Event folder
local CheeseEvent = Window:AddFolder("Cheese Event")

CheeseEvent:AddToggle({
    text = "Auto Cheese",
    state = false,
    callback = function(v)
        autoCheeseEnabled = v
        print("ğŸ§€ Auto Cheese:", v and "ON" or "OFF")
        if v then
            sweepCheeses()
        end
    end
})

CheeseEvent:AddButton({
    text = "Remove Lava",
    callback = function()
        print("ğŸ”¥ Removing lava parts 1â€“8...")
        for i = 1, 8 do
            local lava = LavasFolder:FindFirstChild(tostring(i))
            if lava then
                lava:Destroy()
                print("Destroyed lava #" .. i)
            else
                print("Lava #" .. i .. " not found â†’ skipped")
            end
        end
        print("Remove Lava finished.")
    end
})

library:Init()
print("GUI + Auto Cheese + Remove Lava + Auto Collect Loaded")

-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
-- AUTO BRAINROT CLAIM LOOP
-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

task.wait(4)
task.spawn(scanAndClaim)

task.spawn(function()
    while true do
        task.wait(6)
        if hrp and hrp.Parent and humanoid.Health > 0 then
            scanAndClaim()
        else
            character = player.Character or player.CharacterAdded:Wait()
            hrp = character:WaitForChild("HumanoidRootPart", 10)
            humanoid = character:WaitForChild("Humanoid", 10)
            task.wait(3)
        end
    end
end)

player.CharacterAdded:Connect(function(newChar)
    character = newChar
    hrp = newChar:WaitForChild("HumanoidRootPart", 10)
    humanoid = newChar:WaitForChild("Humanoid", 10)
    task.wait(4)
    print("ğŸ”„ Respawned")
    if autoCheeseEnabled then
        task.wait(0.5)
        sweepCheeses()
    end
end)
