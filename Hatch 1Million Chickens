local Players = game:GetService("Players")
local VirtualUser = game:GetService("VirtualUser")
local TeleportService = game:GetService("TeleportService")
local LocalPlayer = Players.LocalPlayer

-- Permanent Anti-AFK (Always ON - Cannot be disabled)
LocalPlayer.Idled:Connect(function()
    VirtualUser:Button2Down(Vector2.new(0, 0), workspace.CurrentCamera.CFrame)
    task.wait(1)
    VirtualUser:Button2Up(Vector2.new(0, 0), workspace.CurrentCamera.CFrame)
end)

-- Load[c] Zaporium UI Library
local Library = loadstring(game:HttpGet('https://raw.githubusercontent.com/cheyt2025-cyber/HAYS-AI/refs/heads/main/ZAPORIUM'))()

-- Main Window
local Window = Library.CreateWindow({
    Name = "ZAPORIUM",
    LoadingTitle = "Zaporium",
    ConfigurationSaving = {Enabled = false},
    AccentColor = Color3.fromRGB(0, 212, 255),
    Logo = "rbxassetid://112586636995159",
    Credit = "Created by ScriptZap",
    EnableBooting = true
})

-- Info Tab
local InfoTab = Window:CreateTab("Info")

InfoTab:CreateLabel("Welcome to ZAPORIUM!")
InfoTab:CreateLabel("Thank you so much for using my script!")
InfoTab:CreateLabel("Made with love • Fassion")
InfoTab:CreateLabel("I hope you enjoy every second using it!")
InfoTab:CreateLabel("Your support keeps me going!")
InfoTab:CreateLabel("")
InfoTab:CreateLabel("~ ScriptZap")
InfoTab:CreateLabel("ZAPORIUM • Simple, Clean, Powerful")

InfoTab:CreateButton({
    Name = "Join Discord Server",
    Callback = function()
        setclipboard("https://discord.gg/FCwb52g5")
        Window:Notify("Discord link copied to clipboard!", 4)
    end
})

-- FARM TAB (2nd tab as requested)
local FarmTab = Window:CreateTab("Farm")

-- Auto Clicker Toggle
FarmTab:CreateToggle({
    Name = "Auto Clicker",
    CurrentValue = false,
    Callback = function(state)
        if state then
            _G.AutoClickerLoop = task.spawn(function()
                local Network = game:GetService("ReplicatedStorage")
                    :WaitForChild("Libraries")
                    :WaitForChild("Replicate")
                    :WaitForChild("[0] Network")
                    :WaitForChild("Event")

                local DELAY = 0.05

                while task.wait(DELAY) and _G.AutoClickerLoop do
                    local args = {
                        {
                            Type = "Plots",
                            Args = {
                                Type = "IncubatorPressed",
                                Owner = LocalPlayer
                            }
                        }
                    }
                    Network:FireServer(unpack(args))
                end
            end)
        else
            if _G.AutoClickerLoop then
                task.cancel(_G.AutoClickerLoop)
                _G.AutoClickerLoop = nil
            end
        end
    end
})

-- Upgrade Coops Toggle
FarmTab:CreateToggle({
    Name = "Upgrade Coops",
    CurrentValue = false,
    Callback = function(state)
        if state then
            _G.UpgradeCoopsLoop = task.spawn(function()
                local Function = game:GetService("ReplicatedStorage")
                    :WaitForChild("Libraries")
                    :WaitForChild("Replicate")
                    :WaitForChild("[0] Network")
                    :WaitForChild("Function")

                while task.wait(1) and _G.UpgradeCoopsLoop do
                    local args = {
                        {
                            Type = "Coops",
                            Args = {
                                Type = "MinorUpgrade",
                                Multipllier = 1
                            }
                        }
                    }
                    Function:InvokeServer(unpack(args))
                end
            end)
        else
            if _G.UpgradeCoopsLoop then
                task.cancel(_G.UpgradeCoopsLoop)
                _G.UpgradeCoopsLoop = nil
            end
        end
    end
})

-- Upgrade Incubator Toggle
FarmTab:CreateToggle({
    Name = "Upgrade Incubator",
    CurrentValue = false,
    Callback = function(state)
        if state then
            _G.UpgradeIncubatorLoop = task.spawn(function()
                local Function = game:GetService("ReplicatedStorage")
                    :WaitForChild("Libraries")
                    :WaitForChild("Replicate")
                    :WaitForChild("[0] Network")
                    :WaitForChild("Function")

                while task.wait(1) and _G.UpgradeIncubatorLoop do
                    local args = {
                        {
                            Type = "Incubator",
                            Args = {
                                Type = "MinorUpgrade",
                                Multipllier = 1
                            }
                        }
                    }
                    Function:InvokeServer(unpack(args))
                end
            end)
        else
            if _G.UpgradeIncubatorLoop then
                task.cancel(_G.UpgradeIncubatorLoop)
                _G.UpgradeIncubatorLoop = nil
            end
        end
    end
})

-- IMPROVED Auto Collect Egg (now collects from ALL coops automatically)
FarmTab:CreateToggle({
    Name = "Auto Collect Egg",
    CurrentValue = false,
    Callback = function(state)
        if state then
            _G.AutoCollectEggLoop = task.spawn(function()
                local Function = game:GetService("ReplicatedStorage")
                    :WaitForChild("Libraries")
                    :WaitForChild("Replicate")
                    :WaitForChild("[0] Network")
                    :WaitForChild("Function")

                local coopsFolder = workspace:WaitForChild("assets")
                    :WaitForChild("plots")
                    :WaitForChild(LocalPlayer.Name .. "plot")
                    :WaitForChild("core")
                    :WaitForChild("coops")

                while task.wait(1) and _G.AutoCollectEggLoop do
                    for _, coop in pairs(coopsFolder:GetChildren()) do
                        if coop.Name:match("^Coop%d+$") then  -- Matches Coop1, Coop2, Coop3...
                            local args = {
                                {
                                    Type = "Plots",
                                    Args = {
                                        Egg = coop,
                                        Type = "Collect"
                                    }
                                }
                            }
                            Function:InvokeServer(unpack(args))
                        end
                    end
                end
            end)
        else
            if _G.AutoCollectEggLoop then
                task.cancel(_G.AutoCollectEggLoop)
                _G.AutoCollectEggLoop = nil
            end
        end
    end
})

-- Misc Tab (still 3rd tab)
local MiscTab = Window:CreateTab("Misc")

-- Hop Server Button
MiscTab:CreateButton({
    Name = "Hop Server",
    Callback = function()
        Window:Notify("Hopping to a new server...", 3)
        local servers = game.HttpService:JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/"..game.PlaceId.."/servers/Public?sortOrder=Asc&limit=100"))
        local available = {}
        for _, v in pairs(servers.data) do
            if v.playing < v.maxPlayers and v.id ~= game.JobId then
                table.insert(available, v.id)
            end
        end
        if #available > 0 then
            TeleportService:TeleportToPlaceInstance(game.PlaceId, available[math.random(1, #available)], LocalPlayer)
        else
            Window:Notify("No available servers found!", 4)
        end
    end
})

-- WalkSpeed Slider
MiscTab:CreateSlider({
    Name = "WalkSpeed",
    Min = 16,
    Max = 300,
    Default = 16,
    Callback = function(value)
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
            LocalPlayer.Character.Humanoid.WalkSpeed = value
        end
        LocalPlayer.CharacterAdded:Connect(function(char)
            task.wait()
            if char:FindFirstChild("Humanoid") then
                char.Humanoid.WalkSpeed = value
            end
        end)
    end
})

-- Rejoin Server Button
MiscTab:CreateButton({
    Name = "Rejoin Server",
    Callback = function()
        Window:Notify("Rejoining server...", 3)
        task.wait(0.3)
        TeleportService:Teleport(game.PlaceId, LocalPlayer)
    end
})

-- Success Notification
Window:Notify("ZAPORIUM Loaded • Anti-AFK ON", 6)
